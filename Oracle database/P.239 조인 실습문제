#Q1

-SQL99 이전방식

SELECT D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
  FROM EMP E ,DEPT D
 WHERE E.SAL > 2000
    AND E.DEPTNO = D.DEPTNO
ORDER BY D.DEPTNO,E.EMPNO;

-SQL99 방식

SELECT DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
  FROM EMP E NATURAL JOIN DEPT D
 WHERE E.SAL > 2000
ORDER BY DEPTNO,E.EMPNO;




#Q2

-SQL99 이전방식

SELECT D.DEPTNO,D.DNAME,TRUNC(AVG(E.SAL)) AS AVG_SAL,MAX(E.SAL) AS MAX_SAL,
       MIN(E.SAL) AS MIN_SAL, COUNT(*) AS CNT
    FROM EMP E,DEPT D
   WHERE E.DEPTNO = D.DEPTNO
GROUP BY D.DEPTNO,D.DNAME;

-SQL99 방식

SELECT DEPTNO,D.DNAME,TRUNC(AVG(E.SAL)) AS AVG_SAL,MAX(E.SAL) AS MAX_SAL,
       MIN(E.SAL) AS MIN_SAL, COUNT(*) AS CNT
    FROM EMP E NATURAL JOIN DEPT D
GROUP BY DEPTNO,D.DNAME;




#Q3

-SQL99 이전방식

SELECT D.DEPTNO,D.DNAME,E.EMPNO,E.ENAME,E.JOB,E.SAL
    FROM EMP E,DEPT D
  WHERE D.DEPTNO = E.DEPTNO(+)
ORDER BY D.DEPTNO,E.ENAME

-SQL99 방식
SELECT D.DEPTNO,D.DNAME,E.EMPNO,E.ENAME,E.JOB,E.SAL
    FROM EMP E RIGHT OUTER JOIN DEPT D ON(E.DEPTNO = D.DEPTNO)
ORDER BY D.DEPTNO,E.ENAME;




#Q4

-SQL99 이전방식

SELECT D.DEPTNO, D.DNAME,
       E.EMPNO, E.ENAME, E.MGR, E.SAL, E.DEPTNO,
       S.LOSAL, S.HISAL, S.GRADE,
       E2.EMPNO AS MGR_EMPNO, E2.ENAME AS MGR_ENAME
    FROM EMP E,DEPT D,SALGRADE S,EMP E2
  WHERE E.DEPTNO(+) = D.DEPTNO
    AND E.SAL BETWEEN S.LOSAL(+) AND S.HISAL(+)
    AND E.MGR = E2.EMPNO(+)
ORDER BY D.DEPTNO, E.EMPNO; 

-SQL99 방식

SELECT D.DEPTNO, D.DNAME,
       E.EMPNO, E.ENAME, E.MGR, E.SAL, E.DEPTNO,
       S.LOSAL, S.HISAL, S.GRADE,
       E2.EMPNO AS MGR_EMPNO, E2.ENAME AS MGR_ENAME
     FROM EMP E RIGHT OUTER JOIN DEPT D ON (E.DEPTNO = D.DEPTNO)
              LEFT OUTER JOIN SALGRADE S ON (E.SAL BETWEEN S.LOSAL AND S.HISAL)
              LEFT OUTER JOIN EMP E2 ON (E.MGR = E2.EMPNO)
ORDER BY D.DEPTNO, E.EMPNO; 